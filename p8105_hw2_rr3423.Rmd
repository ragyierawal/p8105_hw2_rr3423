---
title: "p8105_hw2_rr3423"
author: "Ragyie Rawal"
date: "10/6/2021"
output: github_document
---

```{r setup, include = FALSE}
library(tidyverse)
library(readxl)
library(lubridate)
```


## PROBLEM 1 

### Mr. Trash Wheel:

```{r mr_trash_wheel}
# importing and cleaning excel file data for Mr. Trash Wheel dataset 
mr_trash_wheel_df = 
  read_excel("data/Trash-Wheel-Collection-Totals-7-2020-2.xlsx",
             sheet = "Mr. Trash Wheel",
             range = "A2:N408") %>% 
  janitor::clean_names() %>% 
  filter(!str_detect(month, 'Total')) %>% 
  mutate(sports_balls = round(sports_balls))
```

### Precipitation Data 2018: 

```{r precipitation_2018}
# reading and cleaning the excel precipitation data for 2018 
precipitation_2018_df = 
  read_excel("data/Trash-Wheel-Collection-Totals-7-2020-2.xlsx",
             sheet = "2018 Precipitation",
             range = "A2:B15") %>% 
  janitor::clean_names() %>% 
  mutate(year = "2018") %>% 
  drop_na()
```

### Precipitation Data 2019:

```{r precipitation_2019}
# reading and cleaning the excel precipitation data for 2019 
precipitation_2019_df = 
  read_excel("data/Trash-Wheel-Collection-Totals-7-2020-2.xlsx",
             sheet = "2019 Precipitation",
             range = "A2:B15") %>% 
  janitor::clean_names() %>% 
  mutate(year = "2019") %>% 
  drop_na()
```

### Combining precipitation datasets:

```{r combine_precipitation_data}
# combining precipitation datasets and converting month to a character variable
precipitation_df =
  bind_rows(precipitation_2018_df, precipitation_2019_df) %>% 
  mutate(month = month.name[month]) %>% 
  relocate(month, year, total)
```

### Data summary 

```{r data_summary_1}
names_p18 = precipitation_2018_df %>% names()
precipitation_18_total = precipitation_2018_df %>% summarise(sum(total))
p18_median = precipitation_2018_df %>% summarise(median(total))
p18_mean = precipitation_2018_df %>% summarise(mean(total))
p18_row = precipitation_2018_df %>% nrow()
p18_col = precipitation_2018_df %>% ncol()

names_p19 = precipitation_2019_df %>% names()
precipitation_19_total = precipitation_2019_df %>% summarise(sum(total))
p19_median = precipitation_2019_df %>% summarise(median(total))
p19_mean = precipitation_2019_df %>% summarise(mean(total))
p19_row =  precipitation_2019_df %>% nrow()
p19_col = precipitation_2019_df %>% ncol()

names_trash = mr_trash_wheel_df %>% names()
trash_rows = mr_trash_wheel_df %>% nrow()
trash_columns = mr_trash_wheel_df %>% ncol()

median_sports_balls = mr_trash_wheel_df %>% 
  filter(year == 2019) %>% 
  summarise(median(sports_balls))
```

The **variable names** in the precipitation 2018 data are **`r names_p18`**. The **total precipitation** in 2018 was **`r precipitation_18_total`**. The **median** precipitation in 2018 was **`r p18_median`**. The **mean** precipitation in 2018 was **`r p18_mean`**. The number of **rows** in the precipitation 2018 data is **`r p18_row`**. The number of **columns** in the precipitation 2018 data is **`r p18_col`**. 

The **variable names** in the precipitation 2019 data are **`r names_p19`**. The **total precipitation** in 2019 was **`r precipitation_19_total`**. The **median** precipitation in 2019 was **`r p19_median`**. The **mean** precipitation in 2019 was **`r p19_mean`**. The number of **rows** in the precipitation 2019 data is **`r p19_row`**. The number of **columns** in the precipitation 2019 data is **`r p19_col`**.

The **variable names** in the Mr. Trash Wheel data are **`r names_trash`**. The number of **rows** in the Mr. Trash Wheel data is **`r trash_rows`**. The number of **columns** in the Mr. Trash Wheel data is **`r trash_columns`**. The **median number of sports balls** in a dumpster in 2019 is **`r median_sports_balls`**.

## PROBLEM 2 

### Cleaning data in pols-month.csv

```{r clean_pols_month}
pols_month_df = 
  read_csv("data/fivethirtyeight_datasets/pols-month.csv") %>% 
  janitor::clean_names() %>% 
  separate(col = mon, into = c("year", "month", "day")) %>%
  mutate(across(.col = c(year, month, day), as.integer)) %>% 
  mutate(month = month.name[month]) %>% 
  mutate(president = case_when(prez_dem == 1 ~ "dem",
                               prez_gop == 1 ~ "gop",
                               prez_gop == 2 ~ "gop")) %>% 
  select(-prez_dem, -prez_gop, -day) %>%
  select(year, month, president, everything())
```

### Cleaning data in snp.csv

```{r clean_snp}
snp_df = 
  read_csv("data/fivethirtyeight_datasets/snp.csv") %>% 
  janitor::clean_names() %>% 
  mutate(date = mdy(date)) %>% 
  separate(date, sep = "-", into = c("year", "month", "day")) %>% 
  mutate(across(.col = c(year, month, day), as.integer)) %>% 
  mutate(month = month.name[month]) %>% 
  select(-day) %>% 
  select(year, month, close, everything()) 
```

### Tidying data in unemployment.csv

```{r clean_unemployment}
unemployment_df = 
  read_csv("data/fivethirtyeight_datasets/unemployment.csv") %>% 
  janitor::clean_names() %>% 
  pivot_longer(
    jan:dec,
    names_to = "month",
    values_to = "unemployment percentage"
  ) %>% 
  mutate(across(.col = c(year), as.integer)) %>% 
  mutate(month = recode(month, "jan" = "January", "feb" = "February", "mar" = "March",
                        "apr" = "April", "may" = "May", "jun" = "June",
                        "jul" = "July", "aug" = "August", "sep" = "September",
                        "oct" = "October", "nov" = "November", "dec" = "December"))
```

### Merging pols-month, snp, and unemployment datasets 

```{r merge_datasets}
merged_df_one = 
  left_join(pols_month_df, snp_df, by = c("year", "month"))

merged_df_final = 
  left_join(merged_df_one, unemployment_df, by = c("year", "month"))
```

### Data summary 

```{r data_summary_2}
names_pols = pols_month_df %>% names()
dimension_pols = pols_month_df %>%  dim()
range_pols = pols_month_df %>% 
  select(year) %>% 
  range()

names_snp = snp_df %>% names()
dimension_snp = snp_df %>% dim()
range_snp = snp_df %>% 
  select(year) %>% 
  range()

names_unemployment = unemployment_df %>% names() 
dimension_unemployment = unemployment_df %>% dim()
range_unemployment = unemployment_df %>% 
  select(year) %>% 
  range()
```





